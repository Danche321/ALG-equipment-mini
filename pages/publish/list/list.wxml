<view class="page-search">
  <!-- 搜索 -->
  <view class="m-page-search" bindtap="handleToSearch">
    <view class="search-box">
      <image class='icon-search' src='../../../icons/search.png'></image>
      <text class="search__input--gray">搜索机械设备</text>
    </view>
  </view>

  <!-- 筛选条件 -->
  <view class="m-page-filter">
    <!-- 选择 -->
    <view class="page-filter-select">
      <view class="filter-item" bindtap="handleShowCity">发货地</view>
      <view class="filter-split"></view>
      <view bindtap="handleShowCategory" class="filter-item {{publishParams.categoryFirstId?'active':''}}">机型</view>
    </view>
    <!-- 选中的标签 -->
    <view wx:if="{{publishParams.searchText||publishParams.categoryFirstId||publishParams.categorySecondId||publishParams.provinceCode||publishParams.cityCode}}" class="page-tags">
      <!-- 关键字 -->
      <view wx:if="{{publishParams.searchText}}" class="tag-item" bindtap="handleClearSearchText">
        <text>{{publishParams.searchText}}</text>
        <image class="icon-clear" src="../../../icons/clear.png"></image>
      </view>
      <!-- 一级类别 -->
      <view wx:if="{{publishParams.categoryFirstId}}" class="tag-item" bindtap="handleClearCategoryFirst">
        <text>{{searchCategoryFirstName}}</text>
        <image class="icon-clear" src="../../../icons/clear.png"></image>
      </view>
      <!-- 二级类别 -->
      <view wx:if="{{publishParams.categorySecondId}}" class="tag-item" bindtap="handleClearCategorySecond">
        <text>{{searchCategorySecondName}}</text>
        <image class="icon-clear" src="../../../icons/clear.png"></image>
      </view>
      <!-- 省份 -->
      <view wx:if="{{publishParams.provinceCode}}" class="tag-item" bindtap="handleClearProvince">
        <text>{{provinceName}}</text>
        <image class="icon-clear" src="../../../icons/clear.png"></image>
      </view>
      <!-- 城市 -->
      <view wx:if="{{publishParams.cityCode}}" class="tag-item" bindtap="handleClearCity">
        <text>{{cityName}}</text>
        <image class="icon-clear" src="../../../icons/clear.png"></image>
      </view>
    </view>
  </view>
</view>

<!-- 内容区 -->
<view class="page-body" style="padding-top:{{marginTop}}px">
  <!-- 发布列表 -->
  <view wx:if="{{publishList.length}}" class="publish-box">
    <view class="publish-column">
      <view wx:if="{{index%2===0}}" wx:for="{{publishList}}" wx:key="{{index}}" class="publish-item" data-id="{{item.id}}" bindtap="handleToDetail">
        <image class="img" src="{{item.mainMedia}}" mode='aspectFill'></image>
        <view class="publish__content">
          <view class="title f-ellipsis2">{{item.title}}</view>
          <view wx:if="{{item.voiceIntroduce}}" id="audio{{item.id}}" data-src="{{item.voiceIntroduce}}" data-id="{{item.id}}" catchtap="handleAudioPlay" class="voice">
            <image wx:if="{{activePlayingId===item.id}}" class='voice__icon' src='../../../icons/audio-playing.gif'></image>
            <image wx:else class='voice__icon' src='../../../icons/voice.png'></image>
            <text class='voice__text'>{{item.voiceIntroduceTime}}s"</text>
          </view>
          <view class="item-priceArea">
            <view wx:if="{{item.outPrice!='未知'}}" class="price">
              ￥
              <text class="price__value">{{item.outPrice}}</text>万
            </view>
            <view wx:else class="price">
              <text class="price__value">面议</text>
            </view>
            <text wx:if="{{item.locationDetail.cityName}}" class="area f-ellipsis1">{{item.locationDetail.provinceName}}·{{item.locationDetail.cityName}}</text>
            <text wx:else class="area f-ellipsis1">{{item.locationDetail.provinceName}}</text>
          </view>
          <view class="user-info f-flex-justStart-alignCenter">
            <image src="{{item.publishUserInfo.headPortrait}}" class="headimg" mode='aspectFill'></image>
            <text class="nickname f-ellipsis1">{{item.publishUserInfo.nickName}}</text>
          </view>
        </view>
      </view>
    </view>
    <view class="publish-column">
      <view wx:if="{{index%2!==0}}" wx:for="{{publishList}}" wx:key="{{index}}" class="publish-item" data-id="{{item.id}}" bindtap="handleToDetail">
        <image class="img" src="{{item.mainMedia}}" mode='aspectFill'></image>
        <view class="publish__content">
          <view class="title f-ellipsis2">{{item.title}}</view>
          <view wx:if="{{item.voiceIntroduce}}" id="audio{{item.id}}" data-src="{{item.voiceIntroduce}}" data-id="{{item.id}}" catchtap="handleAudioPlay" class="voice">
            <image wx:if="{{activePlayingId===item.id}}" class='voice__icon' src='../../../icons/audio-playing.gif'></image>
            <image wx:else class='voice__icon' src='../../../icons/voice.png'></image>
            <text class='voice__text'>{{item.voiceIntroduceTime}}s"</text>
          </view>
          <view class="item-priceArea">
            <view wx:if="{{item.outPrice!='未知'}}" class="price">
              ￥
              <text class="price__value">{{item.outPrice}}</text>万
            </view>
            <view wx:else class="price">
              <text class="price__value">面议</text>
            </view>
            <text wx:if="{{item.locationDetail.cityName}}" class="area f-ellipsis1">{{item.locationDetail.provinceName}}·{{item.locationDetail.cityName}}</text>
            <text wx:else class="area f-ellipsis1">{{item.locationDetail.provinceName}}</text>
          </view>
          <view class="user-info f-flex-justStart-alignCenter">
            <image src="{{item.publishUserInfo.headPortrait}}" class="headimg" mode='aspectFill'></image>
            <text class="nickname f-ellipsis1">{{item.publishUserInfo.nickName}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 无数据 -->
  <view wx:else class='m-page-empty' style="margin-top:{{marginTop/2}}px">
    <image class='empty__img' src="../../../icons/empty.png"></image>
    <text class='empty__text'>没有搜索到符合的设备</text>
  </view>
</view>
<!-- 选择机型组件 -->
<select-category visible="{{selectCategoryVisible}}" firstId="{{publishParams.categoryFirstId}}" secondId="{{publishParams.categorySecondId}}" bind:checked="handleCategoryConfirm"></select-category>

<!-- 选择城市组件 -->
<select-city visible="{{selectCityVisible}}" bind:checked="handleCityConfirm"></select-city>